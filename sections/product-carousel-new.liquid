{{ 'owl.carousel.min.css' | asset_url | stylesheet_tag }}

{% style %}
.PCN-inner {
  padding: 64px 0px;
  padding-left: 36px;
}
[lang="ar"] .PCN-inner {
  padding-left: 0;
  padding-right: 36px;
}
.PCN-header {
  text-align: center;
  margin-bottom: 16px;
}
.PCN-header h3 {
  font-size: 24px;
  font-style: normal;
  font-weight: 400;
  line-height: 30px;
  margin-bottom: 0;
}
.PCN-header a {
  font-size: 14px;
  font-style: normal;
  font-weight: 400;
  line-height: 17px; 
  text-decoration-line: underline;
}
.PCN-slider-wrapper-placeholder {
  width: 100%;
  max-width: 1266px;
  height: 400px;
  background-color: #ccc;
  margin: auto;
}
.PCN-slider-wrapper {
  width:100%;
  max-width: 1266px;
  margin: auto;
}

/* new style*/

/* recommend slider css  */


/* recomended slider image css start  */
span.gray-overlay {
  display: none;
}

.recommendation-product,
.card__media
 {
  padding-top: calc(1020 / 840 * 100%);
  background: #f8f8f8;
  position: relative;
  max-height:530px;
  height:100%;
}

.product-images,
.recently-viewed .card__media>.product-images
{
  position: absolute;
  top: 0;
  bottom: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

.product-images img.motion-reduce {
  mix-blend-mode: multiply;
}

.card__inner:hover .recommendation-product,
.card__inner:hover .card__media
{
  background: linear-gradient(0deg,#000,transparent) no-repeat bottom;
  background-size: 100% 40%;
  opacity: 1;
  cursor: pointer;
}

/* recomnded slider image css end  */

.recommend-product-vendor {
  font-size: 12px;
  line-height: 12px;
  color: #595959;
  letter-spacing: 0.4px;
  text-transform: uppercase;
}
.recommend-product-title {
  line-height: 18px;
  font-size: 16px;
  text-transform: capitalize;
  margin-bottom: 0.4em;
  min-height: 36px;
  font-weight: 400;
  color: #1b1c1e;
  font-family: 'Proxima Nova Rg';
}
.price-item.price-item--regular {
  color: #1b1c1e;
  font-size: 14px;
  line-height: 20px;
  font-weight: 400;
}
.recommend-slider-title {
  text-align: center;
}
.recommendation-product .recent_atc-btn {
  opacity: 0;
}
.recommendation-product:hover .recent_atc-btn {
  opacity: 1;
}
.recent_atc-btn{
  display: flex;
  justify-content: center;
  position: relative;
  bottom: 40px;
  width: fit-content;
  margin: auto;
}
.recommend-slider-title>h4 {
    font-size: 30px;
    font-weight: 300;
    font-family: 'Proxima Nova';
    margin: 50px 0;
    text-transform: capitalize;
    width: 100%;
    color: #1b1c1e;
}
.recommend-product-img {
    margin: 0 20px 0 0;
}
  span.gray-overlay {
    position: absolute;
    opacity: 0.03;
    background-color: #000;
    left: 0;
    top: 0;
    height: 100%;
    width: 100%;
  }
.product-image {
  position: relative;
  z-index: -2;
}
button.notify_me.recommendation-atc.pdp-atc-btn.btn.add-to-cart:hover {
  background: #000;
  color: #fff;
  border: none;
}
.recommendation-slider-container {
 margin: 0 10px;
}
.recommendation-slider-container >a {
 margin-bottom: 4px;
}

.recommendation-product:hover .gray-overlay{
  background: linear-gradient(0deg, #000, transparent) no-repeat bottom;
  background-size: 100% 40%;
  opacity:1;
}
.recommend-btn {
  display: flex;
  justify-content: center;
  bottom: 40px;
  position: relative;
}

button.notify_me.recommendation-atc.pdp-atc-btn.btn.add-to-cart {
  display: inline-block;
  min-width: 137px;
  height: 44px;
  text-align: center;
  transition: 0.3s ease all;
  text-transform: capitalize;
  position: relative;
  z-index: 1;
  line-height: 16px;
  padding-top: 8px;
  padding-bottom: 8px;
  color: #fff;
  border-radius: 0;
  border: 1px solid #fff;
  background-color: #fff;
  color: #000;
}
.recommendation-atc:hover{
  opacity:1;
}
.recommend-product-vendor{
  padding-top:10px;
  margin-bottom: 4px;
}
h2.product-recommendations__heading.h2 {
  font-size: 30px;
  font-weight: 300;
  -webkit-font-smoothing: antialiased;
  margin: 50px 0;
  text-align: center;
  text-transform: capitalize;
  width: 100%;
  color: #1b1c1e;
  z-index: 1;
}

button.available.notify_me.recommendation-atc.pdp-atc-btn.btn.add-to-cart:hover,
 button.notify_me.recommendation-atc.pdp-atc-btn.btn.add-to-cart:hover {
  color: #fff;
  border-color: #595959;
  background-color: #595959;
  box-shadow: none;
}
.PCN-slider-{{ section.id }} .owl-nav .owl-next{
  background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjEiIGhlaWdodD0iMTIiIHZpZXdCb3g9IjAgMCAyMSAxMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGQ9Ik0xOS43NTQzIDZIMCIgc3Ryb2tlPSIjRkZGRkZGIi8+DQo8cGF0aCBkPSJNMTQuOTAwNCAxTDE5Ljc1NDggNkwxNC45MDA0IDExIiBzdHJva2U9IiNGRkZGRkYiLz4NCjwvc3ZnPg0K) !important;
  content: " ";
  background-color: #000 !important;
  padding: 24px;
  color: #fff;
  background-repeat: no-repeat;
  background-position: center;
  cursor: pointer;
  opacity: 1;
  transform: scaleX(1);
  font-size: 0;
  width: 55px;
  position: absolute;
  top: 40%;
  right: -70px;
  left: auto;
}

.PCN-slider-{{ section.id }} .owl-nav .owl-prev {
  background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjEiIGhlaWdodD0iMTIiIHZpZXdCb3g9IjAgMCAyMSAxMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGQ9Ik0xOS43NTQzIDZIMCIgc3Ryb2tlPSIjRkZGRkZGIi8+DQo8cGF0aCBkPSJNMTQuOTAwNCAxTDE5Ljc1NDggNkwxNC45MDA0IDExIiBzdHJva2U9IiNGRkZGRkYiLz4NCjwvc3ZnPg0K) !important;
  content: " ";
  background-color: #000 !important;
  padding: 24px;
  color: #fff;
  background-repeat: no-repeat;
  background-position: center;
  cursor: pointer;
  opacity: 1;
  transform: scaleX(-1);
  font-size: 0;
  width: 55px;
  position: absolute;
  top: 40%;
  left: -70px;
  right: auto;
}
.PCN-slider-{{ section.id }} .grid__item {
  padding-left:0;
  padding-right: 15px;
}
html[lang=ar] .PCN-slider-{{ section.id }} .grid__item {
  padding-left:15px;
  padding-right: 0;
}
.PCN-slider-{{ section.id }} .owl-nav {
display: none;
}
.PCN-slider-{{ section.id }} button.notify_me.recommendation-atc.pdp-atc-btn.btn.add-to-cart, .PCN-slider-{{ section.id }} button.add-to-cart.btn {
  display:none;
}
.PCN-slider-{{ section.id }} .card__inner:hover .recommendation-product, .card__inner:hover .card__media {
  background: #f8f8f8;
}
button.add-to-cart.btn {
    font-family: 'Proxima Nova Rg';
    font-size: 14px;
    text-transform: capitalize;
    font-weight: 100;
}
@media(max-width:767px){
  h3.card__heading.h5.recommend-product-title, .recently-viewed h3.card__heading.h5>a {
    font-size: 13px;
    min-height: 36px; 
    font-weight: 400; 
    color: #1b1c1e;
  }
  .card__media.recommendation-product {
    height: 90%;
  }
  span.gray-overlay {
    height: 100%;
    width: 100%;
  }
  .recently-viewed .card__media {
    margin-bottom: 0px; 
    height: 100%;
  }
  .recommend-slider-title>h4 ,h2.product-recently-view__heading.h2 {
    font-size: 24px;
    font-weight: 300;
  }
  .PCN-inner {
    padding: 64px 16px;
  }
  .PCN-slider-wrapper {
    width: calc(100% + 20px);
    margin-right: -20px;
  }
  html[lang=ar] .PCN-slider-wrapper {
    margin-right: 0px;
    margin-left: -20px;
  }
  button.notify_me.recommendation-atc.pdp-atc-btn.btn.add-to-cart {
    min-width: 90%;
    margin: auto;
  }
}
@media(min-width:1024px){
  .PCN-slider-{{ section.id }} .owl-nav  {
    display: block;
  }
  .PCN-slider-{{ section.id }} button.notify_me.recommendation-atc.pdp-atc-btn.btn.add-to-cart, .PCN-slider-{{ section.id }} button.add-to-cart.btn {
    display:block;
  }
  .PCN-slider-{{ section.id }} .card__inner:hover .recommendation-product, .card__inner:hover .card__media {
    background: linear-gradient(0deg,#000,transparent) no-repeat bottom;
  }
  .PCN-inner, [lang="ar"] .PCN-inner {
    padding: 64px 36px;
  }
  html[lang=ar] .PCN-slider-{{ section.id }} .owl-nav .owl-next, .PCN-slider-{{ section.id }} .owl-nav .owl-prev {
    left: -10px;
    right: auto;
  }
  html[lang=ar] .PCN-slider-{{ section.id }} .owl-nav .owl-prev, .PCN-slider-{{ section.id }} .owl-nav .owl-next {
    left: auto;
    right: -10px;
  }
  .grid__item.product-card.item:first-child {
      padding: 0 10px;
  }
  html[lang=ar] .PCN-slider-{{ section.id }} .owl-nav .owl-prev {
    transform: scaleX(1);
  }
  html[lang=ar] .PCN-slider-{{ section.id }} .owl-nav .owl-next {
    transform: scaleX(-1);
  }
} 
@media (min-width: 1200px){
  html[lang=ar] .PCN-slider-{{ section.id }} .owl-nav .owl-next, .PCN-slider-{{ section.id }} .owl-nav .owl-prev {
    left: -60px;
    right: auto;
  }
  .PCN-inner, [lang="ar"] .PCN-inner {
    padding: 64px 72px;
  }
  html[lang=ar] .PCN-slider-{{ section.id }} .owl-nav .owl-prev, .PCN-slider-{{ section.id }} .owl-nav .owl-next {
    left: auto;
    right: -60px;
  }
}

{% endstyle %}

<div class="PCN-contailer-{{ section.id }}">
  <div class="PCN-inner">
    <div class="PCN-header page-width">
      {% if section.settings.heading != blank %}
      <h3>{{ section.settings.heading }}</h3>
      {%  endif %}
      {% if section.settings.button_link != blank %}
      <a href="{{ section.settings.button_link }}">{{ section.settings.btn_text }}</a>
      {%  endif %}
    </div>
    {% if section.settings.collection != blank %}
    {% assign collection = section.settings.collection %}
      
    <div class="PCN-slider-wrapper">
      <div class="PCN-slider-{{ section.id }} owl-carousel">
        {% for product in collection.products %}
          {% render 'product-card', product:product %}
        {% endfor %}
      </div>
    </div>
    {% else %}
    <div class="PCN-slider-wrapper-placeholder"></div>
    {% endif %}
  </div>
</div>

<script src="{{ 'owl.carousel.min.js' | asset_url }}" defer></script>
<script>
  $(document).ready(function(){
    let rtlViews = window.langify.locale.iso_code == "ar" ? true : false;
    $('.PCN-slider-{{ section.id }}').owlCarousel({
      loop:true,
      nav:true,
      rtl:rtlViews,
      dots: false,
      responsive:{
          0:{
              items:2.4,
          },
          768:{
              items:4.7,
          },
          1024:{
              items:4,
          }
      }
    })
  });   
</script>
<script>
  // add to cart event //
            document.addEventListener("click",(e)=>{
            if(e.target.classList.contains("recommendation-atc") || e.target.closest(".recommendation-atc")){
              console.log(e.target.querySelector("span[data-add-to-cart-text]"),"click event");
                let el = e.target.classList.contains("recommendation-atc") ? e.target : e.target.closest(".recommendation-atc");
               el.querySelector(".load-spinner").classList.remove("hide");           
              el.querySelector("span[data-add-to-cart-text]").style.display = "none";
                const myTimeoutFun = setTimeout(setTimeFun, 600);
                function setTimeFun() {
                 document.querySelector("#count_cart_text").click();
                 $('#miniCart').load(' #miniCart');
                  el.querySelector(".load-spinner").classList.add("hide");
                  el.querySelector("span[data-add-to-cart-text]").style.display = "block";
                }
              // 
              $("#miniCart").load(" #miniCart");
              let variant_id = e.target.closest(".recommendation-atc").getAttribute("data-variant");
              let qty = 1;
              addItemToCart(variant_id, qty);  

            // update cart bubble //
          
            // Fetch the cart data using the Fetch API
           $("#miniCart").load(" #miniCart");
                 fetch('/cart.js').then(res => res.json())
                   .then(data => {
                        if(data.item_count > 0){
                        document.querySelector("#CartCount span").textContent = data.item_count;
                        document.querySelector(".cart-popup__empty").classList.add("hide");
                        document.querySelector(".cart-popup__actions").classList.remove("hide");
                        }
                       })
      
                 function setCartlineItem(line_item,cartDrawerSelector) {
      var itemPric = parseFloat(line_item.line_price / 100);
                     itemPric = itemPric.toFixed(2);
          var cartContent = `<div data-cart-item-index="1" class="cart-popup-item   ">
                              <div class="cart-popup-item__image-wrapper" data-cart-popup-image-wrapper="">
                                <div class="cart-popup-item__image cart-popup-item__image--placeholder" data-cart-popup-image-placeholder="">
                                  <div data-placeholder-size=""> <img class="cart__image" src="${line_item.image.src}" alt="${line_item.image.alt}" data-cart-item-image=""></div>
                                  <div class="placeholder-background placeholder-background--animation"></div>
                                </div>
                              </div>
                              <div class="cart-popup-item__description">
                                <div>
                                  <div class="cart-popup-item__title" data-cart-popup-title="">${line_item.product.title}</div>
								  <div class="cart-product-type"></div>
           
            <div class="cart-product-price">Dhs. ${itemPric}</div>
            
								  
                                  <ul class="product-details" aria-label="Product details" data-cart-popup-product-details="">
                                   <li>
                                      <p class="minicart_remove">
                                        <a href="/cart/change?line=1&amp;quantity=0" class="text-link text-link--accent" data-mini-cart-remove=""><span>Remove</span></a>
                                      </p>
                                    </li>
                                  </ul>
                                    
                                </div>
                               <div class="cart-popup-item__quantity"> 
                                  <span class="visually-hidden" data-cart-popup-quantity-label=""></span>
                                  <span aria-hidden="true"><span>Qty</span>: <span>1</span></span>
                                  <span aria-hidden="true" data-cart-popup-quantity=""></span>
                                  <div class="product-quantity__buttons" data-cart-item-quantity="3" data-mini-cart-item="1" data-mini-cart-item-handle="william-backpack">
                                    <button aria-label="Decrease quantity William Backpack" aria-disabled="true" data-cart-quantity-action="decrease">
                                        <span class="icon css-avaj45 ej69fo90" color="black" role="img"><svg viewBox="0 0 288 288"><path d="M0 136h288v16H0v-16z"></path></svg></span>
                                    </button>
                                    <button aria-label="Increase quantity William Backpack" aria-disabled="false" data-cart-quantity-action="increase" disabled="">
                                       <span class="icon css-avaj45 ej69fo90" color="black" role="img"><svg viewBox="0 0 18 18"><path d="M8.47 8.47V0h1.06v8.47H18v1.06H9.53V18H8.47V9.53H0V8.47h8.47z"></path></svg></span>
                                    </button>
                                  </div>
                                </div>
                              </div>
                            </div>`
    cartDrawerSelector.appendChild(cartContent)
            return image;
        }

       // cart update //

               function renderCart(){
                var minicartSelecter = document.querySelector('#miniCart')
                fetch('/cart.js').then((cart)=>{
                  minicartSelecter.innerHTML = '';
                  cart.items.forEach(function(line_item){
                    setCartlineItem(line_item,minicartSelecter)
                  })
                  // cartDrawerOpen()
                })
              }
            }
          })

  // cart Add to cart button //
   function addItemToCart(variant_id, qty) {
    data = {
      "id": variant_id,
      "quantity": qty,
    }
    jQuery.ajax({
      type: 'POST',
      url: '/cart/add.js',
      data: data,
      dataType: 'json',
      success: function() {
      }
    
    });
    
  }
</script>

{% schema %}
  {
    "name": "Product Carousel New",
    "settings": [
      {
        "type": "text",
        "id": "heading",
        "label": "Heading",
        "default": "New Arrivals"
      },
      {
        "type": "text",
        "id": "btn_text",
        "label": "Button Text",
        "default": "View All"
      },
      {
        "type": "url",
        "id": "button_link",
        "label": "Button link",
        "default": "/collections/all"
      },
      {
        "type": "collection",
        "id": "collection",
        "label": "Collection"
      }
    ],
    "presets": [
      {
        "name": "Product Carousel New",
        "settings": {}
      }
    ]
  }
{% endschema %}